---
layout: post
title:  Helping others to learn Powershell
tags: [Collaboration, Powershell, Modules, Source control]
---

Powershell is great and all, but being one of the few in the Office with scripting knowledge is hard. It's usually not that your coworkers don't want to learn - it's that they don't get enough exposure and don't have enough knowledge about it to see the value.

And if they don't see the value of it, they don't get exposed to it and the circle goes around and around and around. So how can we break this circle? I have a few ideas - Some proven and some theories.

### Make them learn how to fish
I'm not talking about saying "help yourself".
If you write scripts for them - Document and use **[comment based help](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comment_based_help?view=powershell-6)** as much as you can.

Show them how to use `Get-Help` (Yes, you can use it on scripts)  
`Get-Help \\share\scripts\Your-Script.ps1`

`Get-Command` and `Show-Command`.

`Show-Command` is specifically important to some because it gives you an easy GUI to the script.

I made a GUI in Powershell Studio that i call "ScriptExplorer" - it's more of a module explorer really. Showing all cmdlets of a module with a shell and docking the Show-Command of the double-clicked cmdlet. 

[pic]

It shows the command that it's running and the user always sees full documentation of the cmdlets.

Why modules? I'll explain that later.

### Throwing bones
This is super-effective! Just do it the right way and don't do all their work for them, remember that the goal is to make them self reliant.

You could give the Sharepoint-people a script to automatically push some data to excel easily or give the server team a script to fully patch new servers.

If you throw them a few of these, with proper comment based help (remember: make them learn `Show-Command`,`Get-Command` and most importantly `Get-Help`) they will soon start to make a few of their own.

It's here that the important stuff starts: Be supportive in **assisting them** to make their scripts, not to make their scripts for them.

This will take some time for sure, but it's probably worth it.


### Source control and a Powershell Repository

Source control is great and you can the the use in that, but a PSRepo?

We stored our scripts in a share, that was synced with our SC.
This works well for a few scripts, but as the pile grew it became more and more unmanagable.

So then we decided to put all our scripts into functions, and those functions were put into appropriate modules for the different teams and roles.

It's sooooo much better to have all scripts you need available as soon as you open the terminal. And keeping it up to date is easy, just type: `Update-Module <module name>`

Our workflow for creating these are:

1. Add code to TFS
2. TFS sends build command to Jenkins
3. Jenkins builds the module with the help of PSake and PlatyPS
4. Jenkins publishes the module to our private powershell repo.
5. Pandoc converts .md files generated by platyPS to html and adds them to a Sharepoint page for that module.

#### Source control
GIT, TFS/VSTS and Gitlab are great choices.

This gives you the ability to collaborate and it gives you version control over your scripts. Nice thing is that they integrate into VSCode as well.

#### Powershell Repository

A place to store your modules is almost a must.
Not just your own, but modules like DBATools etc so that you can see to that they are available at all times and that you have control over the version used.

Creating a regular Powershell Repository is easy. Kevmar wrote a great guide on [creating your first internal PSScript repository](https://kevinmarquette.github.io/2017-05-30-Powershell-your-first-PSScript-repository/).